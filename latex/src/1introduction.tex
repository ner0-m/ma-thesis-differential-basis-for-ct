\chapter{Motivation and Context}\label{chap:introduction}

In \citeyear{rontgen_uber_1895} \citeauthor{rontgen_uber_1895} discovered X-rays. Since then
different methods based on X-ray have been revolutionizing medical treatment. For the first time it
was possible to inspect (among others) the human body non-intrusively, i.e.\ without cutting it
open. It was used among others to detect metal objects in the body such as
bullets~\cite{haygood_skeletal_1996}. But also new kinds of fractures could be detected and
diagnosed. New bone diseases could be discovered such as Osteopoikilosis, or others such as skeletal
tuberculosis~\cite{haygood_skeletal_1996} could be identified.

The next major step was the invention of \textit{X-ray attenuation computed tomography} (CT). The
first prototypes were developed at EMI laboratories and resulted in a series of publications
~\cite{hounsfield_computerized_1973,ambrose_computerized_1973, perry_computerized_1973}. Compared to
simple X-ray images, X-ray attenuation CT can create cross-sectional images from the interior of the
scanned object. Whereas, in tradition X-ray imaging different objects superimpose each other, X-ray
attenuation CT can distinguish them. Since its introduction, X-ray attenuation CT is a standard tool
in medical diagnostics. Medical applications include but are by no means limited to the detection of
infarction, tumours, calcifications, haemorrhage and bone trauma~\cite[Chapter 5]{buchanan_advanced_2012}.
However, X-ray attenuation does lack soft-tissue contrast\cite{pfeiffer_phase_2006}. I.e.\
tissues with similar attenuation coefficient are hard to distinguish.

Phase-contrast X-ray imaging improves this specific issues~\cite{lewis_medical_2004} plus it can
reveal additional information~\cite{hahn_numerical_2012}. One way to measure phase-contrast for
X-rays are grating interferometer~\cite{pfeiffer_hard-x-ray_2008}. This information can be measured
using the refraction of X-rays, instead of the attenuation. Specifically, the phase gradient
perpendicular to the gratings can be measured, therefore, this method is often referred to as
\textit{differential phase-contrast imaging}.

Additionally, the same grating interferometer yields further information about small-angle
scattering. Imaging modalities based on this property are referred to as \textit{X-ray dark-field
	imaging}. Studies have been proposed for many different medical applications, see~\cite[Chapter
	1.3.1]{wieczorek_anisotropic_2017} for an overview of the different fields. Only recently, the
grating interferometer setup was incorporated into a clinical CT
scanner~\cite{viermetz_dark-field_2022}.

This is the working context of the research group \textit{\gls{CIIP}} at the \gls{TUM} around my
supervisor PD Dr.\ rer.\ nat.\ Tobias Lasser. Specifically, at the research group the open-source
C++ framework \textit{elsa} is developed for use in tomographic reconstruction. One goal of elsa, is
to provide open access to the research done at the group, plus it should improve the reproducibility
of the work done. Therefore, support for imaging modalities such as phase-contrast or dark-field
imaging enables the research group to increase the accessibility and reproducibility of their
research. But like many other known frameworks, elsa currently only supports X-ray attenuation CT\@.
But for the accessibility and reproducibility reasons, there exists high interest to support both
X-ray phase-contrast and dark-field imaging modalities in elsa. This support should include both
common, state-of-the-art and novel algorithms for tomographic reconstruction. Without common and
current state-of-the-art algorithms, no proper evaluation and/or comparison to novel techniques can
be made.

Though, they are different modalities they do have a common basis. All of the above mentioned
imaging modalities can be sorted in the group of \textit{tomographic reconstruction}, which itself
is a subset of \textit{inverse problems}. The challenge for this class of problems, is the
reconstruction of a signal from a finite set of projections. The connection between the problem
domain and the measurement domain is the so-called \textit{forward model}. In tomographic
reconstruction, the forward model is based on the line integral.

The forward model for these modalities assumes X-rays traveling throughout some object in a straight
line. Hence, some quantity (i.e.\ the attenuation coefficients of an object) can be integrated along
the path of the X-ray. This is just a line. Such a quantity can be fully described by the infinite
set of lines from different projection angles. This has been proven multiple times over history.
However, most often it is attributed to \citeauthor*{radon_uber_1917} in \citeyear{radon_uber_1917}
~\cite{radon_user_1917}. Therefore, the integral transform, which maps a function into its set of
line integrals is referred to as \textit{Radon Transform}. Other than \citeauthor*{radon_uber_1917},
\citeauthor*{cormack_representation_1963}~\cite{cormack_representation_1963} rediscovered it without
the knowledge of the work done by \citeauthor*{radon_uber_1917}.
\citeauthor*{cormack_representation_1963} laied the theoretical foundation of modern CT scanners.
And \citeauthor*{hounsfield_computerized_1973}~\cite{hounsfield_computerized_1973} build the first
working prototypes. For that, both \citeauthor*{cormack_representation_1963} and
\citeauthor*{hounsfield_computerized_1973} received the Nobel Prize in Medizine 1979.

To successfully reconstruct a signal from its projections, a couple of key steps need to be
performed. First, the forward model has to be described precisely. Next, the problem needs to be
discretized. This leads to a system of linear equations. The final step is to find a solution for
this system of linear equations.

Of great interest for this thesis is the discretization aspect. A common approach to discretization
is the series expansion~\cite{herman_basis_2015}. The signal is described via a of coefficient
vector and a set of basis functions. The choice of basis function has great influence on the quality
of the discretization. But not only that, usually signals in tomographic reconstructions are
considered smooth, i.e.\ continuously differentiable. However, arguably the most common basis
functions --- the pixel- or voxel- basis function --- is not differentiable at its boundaries. This
creates problems in imaging modalities that expect a differentiable problem domain, such as
differentiable phase-contrast imaging. Therefore, it is of interest to investigate basis functions,
which are continuously differentiable.

\citeauthor*{lewitt_multidimensional_1990} introduced a family of spherically symmetric basis
functions often referred to as \textit{blobs}. It received a lot of attention in the tomographic
space, as it overcomes quite a few limitations of the pixel- and voxel basis functions. Among
others, it is continuously differentiable. Another interesting set of basis functions is not as
common in the tomographc space: Basis-Splines (or usually only B-Spline). B-Splines are mostly known
from function approximation. There exists a closed form solution for an continuously approximation
of signals using B-Splines~\cite{unser_fast_1991}. Though, this thesis follows the approach laied out
by \citeauthor*{momey_new_2011}~\cite{momey_new_2011,momey_b-spline_2012, momey_spline_2015}, a lot
of the properties are still relevant. B-Spline tend to spherically symmetric functions, but preserve
a compact support. Further, they are also continuously differential (up to a certain degree).

Once the problem domain is discretized using another basis function apart from the pixel- or
voxel-basis function, another issue need to be solved. Many method exists to compute the line
integral. However, most methods assume the pixel- or voxel basis function. Hence, they have to be
extended to use other basis functions.

The last two points are the main contribution of this thesis. The approximation of the line integral
relying on other basis functions than the pixel- or voxel basis functions are implemented in elsa.
This implicitly includes a discretization of the signal in the new basis functions. However, it
should be noted, that at no point in time the problem domain is transformed to a new basis
functions.

\section{Outline}\label{sec:outline}

As already mentioned, there are three steps involved to tomographic reconstruction on computers.
There needs to be an understanding and description of the forward model. The problem needs to be
discretized and finally a solution needs to be computed. These parts are covered in
\autoref{part:foundation}

The first of these three steps is discussed in \autoref{chap:imaging_modalities}. This discussion
includes first a short introduction in the mathematical class of inverse problems followed by a
description of X-ray attenuation CT\@ and differential phase-contrast CT is also given. This
includes an introduction to the physical and mechanical mechanism of the different methods.

Next, based on the more engineering oriented approach, the mathematical basic forward model for
tomographic reconstruction is described in \autoref{chap:radon_transform_and_related}. There,
important mathematical concepts, such as the Radon Transform, are introduced and discussed.

With that, the first of the three steps is discussed. In \autoref{chap:signal_representation}, the
discretization of the problem is discussed in detail. This includes the discussion of the pixel- or
voxel-basis function, the family of spherically symmetric basis function introduced by
\citeauthor*{lewitt_multidimensional_1990} and B-Splines basis functions.

As a final piece of the puzzle, an introduction to finding a solution to tomographic reconstruction
problem is given in \autoref{chap:tomographic_reconstruction}. This includes a discussion of
analytical, iterative reconstruction and regularized reconstruciton algorithms.

Moving away from a mathematical centered discussion, \autoref{part:practical} looks intro the C++
framework elsa in \autoref{chap:elsa}. This is followed by a detailed discussion of the
implementational aspects of computing the line integral, with a focus on other basis functions in
\autoref{chap:projector}. Finally, a detailed evaluation of the new implementations of the line
integral is conduted in \autoref{chap:experiments}

\autoref{part:conclusion} completes the thesis with a summary of the newly implemented projectors in
\autoref{chap:conclusion}, and an outlook for future work.

\section{Disclaimer}\label{sec:disclaimer}

I want my research to be as open, reproducible and comprehensible as possible. Hence, the
development of the source code I've written is open source, discussions (though they were few) can be
found in the \href{https://gitlab.lrz.de/IP/elsa}{elsa GitLab repository}, the \LaTeX{} source code
of thesis can be found on my
\href{https://github.com/ner0-m/ma-thesis-differential-basis-for-ct}{personal GitHub page}. To the
best of my possibilities, I try to include the code I've used to generate all of my plots and
graphs, I try to state dependencies and make building and using my work as easy as I can. But of
course, I am aware, what is easy to me, might be cumbersome to the next, and impossible to the
other.

\inlinetodo{disclaimer gender-neutral language}
